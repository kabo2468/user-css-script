// ==UserScript==
// @name        Misskey MFM Helper
// @version     1.0.1
// @author      kabo2468
// @description Help to write MFM
// @supportURL  https://github.com/kabo2468/user-css-script/issues
// @match       https://misskey.io/*
// @namespace   kabo2468.mmhujs
// @grant       none
// @require     none
// @downloadURL https://kabo2468.github.io/user-css-script/misskey-mfm-helper.user.js
// @updateURL   https://kabo2468.github.io/user-css-script/misskey-mfm-helper.meta.js
// @homepageURL https://kabo2468.github.io/user-css-script/
// ==/UserScript==

(()=>{const e=[{name:"リンク",text:"[|](URL)"},{name:"太字",text:"**|**"},{name:"目立たなく",text:"<small>|</small>"},{name:"中央寄せ",text:"<center>|</center>"},{name:"コード(インライン)",text:"`|`"},{name:"コード(ブロック)",text:"```\n|\n```"},{name:"数式(インライン)",text:"\\(|\\)"},{name:"引用",text:"> |"},{name:"検索",text:"| 検索"},{name:"びよんびよん",text:"$[jelly |]"},{name:"じゃーん",text:"$[tada |]"},{name:"ジャンプ",text:"$[jump |]"},{name:"バウンド",text:"$[bounce |]"},{name:"ぶるぶる",text:"$[shake |]"},{name:"ブレ",text:"$[twitch |]"},{name:"右回転",text:"$[spin |]"},{name:"左回転",text:"$[spin.left |]"},{name:"往復回転",text:"$[spin.alternate |]"},{name:"縦右回転",text:"$[spin.x |]"},{name:"縦左回転",text:"$[spin.x,left |]"},{name:"縦往復回転",text:"$[spin.x,alternate |]"},{name:"横右回転",text:"$[spin.y |]"},{name:"横左回転",text:"$[spin.y,left |]"},{name:"横往復回転",text:"$[spin.y,alternate |]"},{name:"左右反転",text:"$[flip |]"},{name:"上下反転",text:"$[flip.v |]"},{name:"上下左右反転",text:"$[flip.h,v |]"},{name:"明朝体",text:"$[font.serif |]"},{name:"等幅フォント",text:"$[font.monospace |]"},{name:"手書きフォント",text:"$[font.cursive |]"},{name:"装飾フォント",text:"$[font.fantasy |]"},{name:"大きく",text:"$[x2 |]"},{name:"とても大きく",text:"$[x3 |]"},{name:"究極に大きく",text:"$[x4 |]"},{name:"ぼかし",text:"$[blur |]"},{name:"レインボー",text:"$[rainbow |]"}];setInterval((()=>{const t=document.querySelectorAll(".gafaadew>header>div");t.length&&t.forEach((t=>{if(t.getElementsByClassName("mmhujs-open-btn").length)return;const n=function(){const t=document.createElement("button");return t.classList.add("mmhujs-open-btn"),t.textContent="MFM",t.style.marginRight="8px",t.addEventListener("click",(()=>{if(document.getElementById("mmhujs-list"))return;const t=function(){const t=document.createElement("div");t.id="mmhujs-list",t.style.backgroundColor="rgba(255, 255, 255, 0.7)",t.style.position="absolute",t.style.left="100px",t.style.top="100px",t.style.width="400px",t.style.zIndex="10000";const n=document.createElement("button");n.id="mmhujs-close-btn",n.textContent="Close",n.addEventListener("click",(()=>{t.remove()}));const a=document.createElement("div");a.append(n);const m=document.createElement("div");return m.style.padding="15px 20px 20px",m.append(...e.map((e=>{const t=document.createElement("button");return t.textContent=e.name,t.addEventListener("click",(()=>{const t=document.getElementsByTagName("textarea");Array.from(t).forEach((t=>{const n=t.value,a=t.selectionStart,m=e.text.indexOf("|");t.value=`${n.slice(0,a)}${e.text.replace("|","")}${n.slice(a)}`;const o=a+m;t.focus(),t.setSelectionRange(o,o)}))})),t}))),t.append(a,m),t.addEventListener("mousedown",(function(e){const n=e.clientX-t.getBoundingClientRect().left,a=e.clientY-t.getBoundingClientRect().top;function m(e,m){t.style.left=e-n+"px",t.style.top=m-a+"px"}function o(e){m(e.pageX,e.pageY)}m(e.pageX,e.pageY),document.addEventListener("mousemove",o),t.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",o),t.removeEventListener("mouseup",e)}))})),t.addEventListener("dragstart",(()=>!1)),t}();document.body.append(t)})),t}();n.style.display="inline-block",t.prepend(n)}))}),1e3)})();